export class Cast{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static boolean(value){if(!value||value===false||value==="false"||value===0||value==="0"||value==="no"||value==="off")return false;return true}}const MASKS=["cpf","cnpj","cep","phone","slug","alphaNumeric","currency"];export class Mask{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static byName(selector,maskName,options={}){if(MASKS.indexOf(maskName)===-1)return;return Mask[maskName](selector,options)}static mask(selector,mask,options={}){return $(selector).mask(mask,options)}static currency(selector,options={}){return Mask.mask(selector,"#.##0,00",{reverse:true,...options})}static cpf(selector,options={}){return Mask.mask(selector,"999.999.999-99",options)}static cnpj(selector,options={}){return Mask.mask(selector,"99.999.999/9999-99",options)}static cep(selector,options={}){return Mask.mask(selector,"99.999-999",options)}static phone(selector,options={}){const phoneMask=val=>{return val.replace(/\D/g,"").length===11?"(00) 00000-0000":"(00) 0000-00009"};return Mask.mask(selector,phoneMask,{onKeyPress:function(val,e,field,options){field.mask(phoneMask.apply({},arguments),options)}})}static slug(selector){return $(selector).on("input",e=>{$(e.target).val(e.target.value.replace(/[^a-z0-9\/._-]/gi,""))})}static alphaNumeric(selector){return $(selector).on("input",e=>{$(e.target).val(e.target.value.replace(/[^a-z0-9]/gi,""))})}static number(selector,options={}){return $(selector).on("input",e=>{$(e.target).val(e.target.value.replace(/[^0-9\/.,+\-*:]/g,""))})}static strictNumber(selector,options={}){return $(selector).on("input",e=>{$(e.target).val(e.target.value.replace(/[^0-9]/g,""))})}}export class Validator{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static validate(value,rule,params){return Validator[rule](value,params)}static currency(value="",params=null){return!/[^0-9\/.,]/.test(value)}static cep(value="",params=null){if(!value||value==="")return false;return value.length===8||value.length===10}static cpf(value="",params=null){if(!value||value===""||value.length!==11&&value.length!==14||!/^\d{3}\.\d{3}\.\d{3}\-\d{2}$/.test(value))return false;const cpf=value.replace(/[\s.-]*/gim,"");let sum=0,rest,i;if(cpf==="00000000000"||cpf==="11111111111"||cpf==="22222222222"||cpf==="33333333333"||cpf==="44444444444"||cpf==="55555555555"||cpf==="66666666666"||cpf==="77777777777"||cpf==="88888888888"||cpf==="99999999999")return false;for(i=1;i<=9;++i)sum=sum+parseInt(cpf.substring(i-1,i))*(11-i);rest=sum*10%11;if(rest===10||rest===11)rest=0;if(rest!==parseInt(cpf.substring(9,10)))return false;sum=0;for(i=1;i<=10;++i)sum+=parseInt(cpf.substring(i-1,i))*(12-i);rest=sum*10%11;if(rest===10||rest===11)rest=0;if(rest!==parseInt(cpf.substring(10,11)))return false;return true}static cnpj(value="",params=null){if(!value||value===""||value.length!==14&&value.length!==18||!/^\d{2}\.\d{3}\.\d{3}\/\d{4}\-\d{2}$/.test(value))return false;const cnpj=value.replace(/[^\d]+/g,"");if(cnpj==="00000000000000"||cnpj==="11111111111111"||cnpj==="22222222222222"||cnpj==="33333333333333"||cnpj==="44444444444444"||cnpj==="55555555555555"||cnpj==="66666666666666"||cnpj==="77777777777777"||cnpj==="88888888888888"||cnpj==="99999999999999")return false;let i,size=cnpj.length-2,numbers=cnpj.substring(0,size),digits=cnpj.substring(size),sum=0,pos=size-7;for(i=size;i>=1;--i){sum+=numbers.charAt(size-i)*pos--;if(pos<2)pos=9}if(String(sum%11<2?0:11-sum%11)!==digits.charAt(0))return false;size=size+1;numbers=cnpj.substring(0,size);sum=0;pos=size-7;for(i=size;i>=1;--i){sum+=numbers.charAt(size-i)*pos--;if(pos<2)pos=9}if(String(sum%11<2?0:11-sum%11)!==digits.charAt(1))return false;return true}static required(value=null,params=null){return Boolean(value&&value.length)}static strictNumber(value="",params=null){return!/[^0-9]/.test(value)}static number(value="",params=null){if(isNaN(value)||!String(value).length)return false;return!/[^0-9\/.,+\-*:]/.test(value)}static email(value="",params=null){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(value)}static length(value="",params=null){return Validator.required(value)&&value.length>params-1}static match(value="",params=null){return value&&params&&value===params}static minchars(value="",params=null){return Validator.required(value)&&value.length>params-1}static maxchars(value="",params=null){return Validator.required(value)&&value.length<params-1}static passwordconfirm(value="",params=null){return Validator.required(value)&&value===$(params).val()}static atleast(value=null,params=null){if(!Array.isArray(value))return false;return value.length>=Number(params)}static strongpassword(value="",params=null){const result=Validator.passwordComposition(value,0);return result.lowerCaseLetter&&result.upperCaseLetter&&result.digit&&result.specialCharacter}static passwordComposition(password,minimumLength=0){if(!password||!password.length)return{lowerCaseLetter:false,upperCaseLetter:false,digit:false,specialCharacter:false,length:0,minimumLength:false};return{lowerCaseLetter:/[a-z]/.test(password),upperCaseLetter:/[A-Z]/.test(password),digit:/\d/.test(password),specialCharacter:/[^A-Za-z0-9]/.test(password),length:password.length,minimumLength:minimumLength===0?true:password.length>minimumLength-1}}static parseRulesByAttribute(validation){const result=[];validation=validation.split("|");for(const validationRule of validation){const[rule,params]=validationRule.split(":");result.push({rule:rule.trim(),params:(params||"").trim().split(",")})}return result}}export const C=67;export const V=86;export const X=88;export const ARROWS=[37,38,39,40];export const NUMBERS=[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105];export const POINT=[108,190];export const PLUS=[43,107];export const MINUS=[109,173];export const COMMA=[44,110];export const TAB=9;export const BACKSPACE=8;export const DELETE=46;export const ENTER=13;export const ESC=27;export const CONTROL=17;export const ALT=18;export const SHIFT=16;export const WINDOWS=91;export const RIGHT_MOUSE_MENU=93;export const NECESSARY_KEYS=[TAB,BACKSPACE,DELETE,ENTER,ESC,CONTROL,ALT,SHIFT,WINDOWS,RIGHT_MOUSE_MENU,...ARROWS];export const NUMBERS_AND_SIGNS=[...NUMBERS,...POINT,...PLUS,...MINUS,...COMMA,...NECESSARY_KEYS];export class ASC2{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static checkSelection(event){if(!event.ctrlKey&&!event.shiftKey)return false;return ARROWS.indexOf(event.keyCode||event.which)!==-1}static checkCutCopyAndPaste(event){return ASC2.checkCut(event)||ASC2.checkCopy(event)||ASC2.checkPaste(event)}static checkCopyAndPaste(event){return ASC2.checkCopy(event)||ASC2.checkPaste(event)}static checkCutAndPaste(event){return ASC2.checkCut(event)||ASC2.checkPaste(event)}static checkCopy(event){if(!event.ctrlKey)return false;return(event.keyCode||event.which)===C}static checkCut(event){if(!event.ctrlKey)return false;return(event.keyCode||event.which)===X}static checkPaste(event){if(!event.ctrlKey)return false;return(event.keyCode||event.which)===V}}export class NumberUtil{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static format(length,decimals=2,punctuation="."){let maskLength=length-(decimals+1),maskDecimals=punctuation+Array(decimals).fill("0").join(""),mask="",counter=0;maskLength=Math.floor(maskLength+(maskLength%3!==0?1:0));if(maskLength>0){while(--maskLength){mask+="0";if(++counter===3){mask+=punctuation;counter=0}}}return mask.split("").reverse().join("")+maskDecimals}}const LOCALE="pt-br",CURRENCY_OPTIONS={style:"currency",currency:"BRL"};export class StringUtil{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static trim(string,characters=null){return string.replace(new RegExp(!characters?"^\\s+|\\s+$":"^"+characters+"+|"+characters+"+$","g"),"")}static rtrim(string,characters=null){return string.replace(new RegExp(!characters?"\\s+$":characters+"+$"),"")}static ltrim(string,characters=null){return string.replace(new RegExp(!characters?"^\\s+":"^"+characters+"+"),"")}static sanitize(value=null){return String(value||"").trim()}static removeSpecialChars(value=null){return String(value||"").replace(/[^a-zA-Z0-9]/g,"")}static sanitizeCurrency(value=null){return String(value||"").replaceAll(",",".")}static dateToMySQLFormat(date=null){if(!date)return"";date=date.split("/");return`${String(date[2]||"").trim()}-${String(date[1]||"").trim()}-${String(date[0]||"").trim()}`}static dateToPTBRFormat(date=null){if(!date)return"";date=date.split(" ");const days=(date[0]||"").split("-");date=String(days[2]||"").trim()+"/"+String(days[1]||"").trim()+"/"+String(days[0]||"").trim();return`<span class="date" data-value="${date}">${date}</span>`}static formatCPF(value=null){if(!value)return"";value=value.replace(/[^\d]/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");return`<span class="document cpf" data-value="${value}">${value}</span>`}static formatCNPJ(value=null){if(!value)return"";value=value.replace(/[^\d]/g,"").replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5");return`<span class="document cnpj" data-value="${value}">${value}</span>`}static formatCurrency(value=null){if(!value)return"";value=String(value);const symbol=value.indexOf("R$")===-1&&value.indexOf("R$ ")===-1?'<span class="currency-symbol">R$</span> ':"";value=String(Number(value).toFixed(2)).toLocaleString(LOCALE,CURRENCY_OPTIONS).replace(".",",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");return'<span class="currency">'+(value?symbol+`<span class="currency-value" data-value="${value}">${value}</span>`:"")+"</span>"}static slug(string){let from="åàáäâèéëêìíïîòóöôõùúüûñç·/_,:;",to="aaaaaeeeeiiiiooooouuuunc------";let i,total=from.length;string=string.replace(/<.*?>/g,"").trim().replaceAll(/^\s+|\s+$/g,"").toLowerCase();for(i=0;i<total;++i)string=string.replace(new RegExp(from.charAt(i),"g"),to.charAt(i));return string.replaceAll(/[^a-z0-9 -]/g,"").replaceAll(/\s+/g,"-").replaceAll(/-+/g,"-").trim()}static sprintf(key){return sprintfFormat(sprintfParse(key),arguments)}static vsprintf(fmt,argv){return StringUtil.sprintf.apply(null,[fmt].concat(argv||[]))}}const sprintFRegExp={notString:/[^s]/,notBool:/[^t]/,notType:/[^T]/,notPrimitive:/[^v]/,number:/[diefg]/,numericArg:/[bcdiefguxX]/,json:/[j]/,notJson:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,keyAccess:/^\.([a-z_][a-z_\d]*)/i,indexAccess:/^\[(\d+)\]/,sign:/^[+-]/};const sprintfFormat=(parseTree,argv)=>{let cursor=1,treeLength=parseTree.length,arg,output="",i,k,ph,pad,padCharacter,padLength,isPositive,sign;for(i=0;i<treeLength;i++){if(typeof parseTree[i]==="string")output+=parseTree[i];else if(typeof parseTree[i]==="object"){ph=parseTree[i];if(ph.keys){arg=argv[cursor];for(k=0;k<ph.keys.length;k++){if(arg==undefined)throw new Error(StringUtil.sprintf('[sprintf] Cannot access property "%s" of undefined value "%s"',ph.keys[k],ph.keys[k-1]));arg=arg[ph.keys[k]]}}else if(ph.paramNo)arg=argv[ph.paramNo];else arg=argv[cursor++];if(sprintFRegExp.notType.test(ph.type)&&sprintFRegExp.notPrimitive.test(ph.type)&&arg instanceof Function)arg=arg();if(sprintFRegExp.numericArg.test(ph.type)&&(typeof arg!=="number"&&isNaN(arg)))throw new TypeError(StringUtil.sprintf("[sprintf] expecting number but found %T",arg));if(sprintFRegExp.number.test(ph.type))isPositive=arg>=0;switch(ph.type){case"b":arg=parseInt(arg,10).toString(2);break;case"c":arg=String.fromCharCode(parseInt(arg,10));break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,ph.width?parseInt(ph.width):0);break;case"e":arg=ph.precision?parseFloat(arg).toExponential(ph.precision):parseFloat(arg).toExponential();break;case"f":arg=ph.precision?parseFloat(arg).toFixed(ph.precision):parseFloat(arg);break;case"g":arg=ph.precision?String(Number(arg.toPrecision(ph.precision))):parseFloat(arg);break;case"o":arg=(parseInt(arg,10)>>>0).toString(8);break;case"s":arg=String(arg);arg=ph.precision?arg.substring(0,ph.precision):arg;break;case"t":arg=String(!!arg);arg=ph.precision?arg.substring(0,ph.precision):arg;break;case"T":arg=Object.prototype.toString.call(arg).slice(8,-1).toLowerCase();arg=ph.precision?arg.substring(0,ph.precision):arg;break;case"u":arg=parseInt(arg,10)>>>0;break;case"v":arg=arg.valueOf();arg=ph.precision?arg.substring(0,ph.precision):arg;break;case"x":arg=(parseInt(arg,10)>>>0).toString(16);break;case"X":arg=(parseInt(arg,10)>>>0).toString(16).toUpperCase();break}if(sprintFRegExp.json.test(ph.type))output+=arg;else{if(sprintFRegExp.number.test(ph.type)&&(!isPositive||ph.sign)){sign=isPositive?"+":"-";arg=arg.toString().replace(sprintFRegExp.sign,"")}else sign="";padCharacter=ph.padChar?ph.padChar==="0"?"0":ph.padChar.charAt(1):" ";padLength=ph.width-(sign+arg).length;pad=ph.width?padLength>0?padCharacter.repeat(padLength):"":"";output+=ph.align?sign+arg+pad:padCharacter==="0"?sign+pad+arg:pad+sign+arg}}}return output};const sprintfCache=Object.create(null);const sprintfParse=fmt=>{if(sprintfCache[fmt])return sprintfCache[fmt];let _fmt=fmt,match,parseTree=[],argNames=0;while(_fmt){if((match=sprintFRegExp.text.exec(_fmt))!==null)parseTree.push(match[0]);else if((match=sprintFRegExp.modulo.exec(_fmt))!==null)parseTree.push("%");else if((match=sprintFRegExp.placeholder.exec(_fmt))!==null){if(match[2]){argNames|=1;let fieldList=[],replacementField=match[2],fieldMatch=[];if((fieldMatch=sprintFRegExp.key.exec(replacementField))!==null){fieldList.push(fieldMatch[1]);while((replacementField=replacementField.substring(fieldMatch[0].length))!==""){if((fieldMatch=sprintFRegExp.keyAccess.exec(replacementField))!==null)fieldList.push(fieldMatch[1]);else if((fieldMatch=sprintFRegExp.indexAccess.exec(replacementField))!==null)fieldList.push(fieldMatch[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key")}}else throw new SyntaxError("[sprintf] failed to parse named argument key");match[2]=fieldList}else argNames|=2;if(argNames===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parseTree.push({placeholder:match[0],paramNo:match[1],keys:match[2],sign:match[3],padChar:match[4],align:match[5],width:match[6],precision:match[7],type:match[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");_fmt=_fmt.substring(match[0].length)}return sprintfCache[fmt]=parseTree};export class EventDispatcher{constructor(target=window){this._target=target;this._$target=$(target);this._interactive=true}on(){if(!this._interactive)return this;this._$target.on.apply(this._$target,[].slice.call(arguments));return this}one(){if(!this._interactive)return this;this._$target.one.apply(this._$target,[].slice.call(arguments));return this}off(){if(!this._interactive)return this;this._$target.off.apply(this._$target,[].slice.call(arguments));return this}trigger(){if(!this._interactive)return this;this._$target.trigger.apply(this._$target,[].slice.call(arguments));return this}get target(){return this._target}set target(value){this._target=value}get $target(){return this._$target}set $target(value){this._$target=value}get interactive(){return this._interactive}set interactive(value){this._interactive=value}}const _eventDispatcher=new EventDispatcher;export class StaticEventDispatcher{constructor(){throw new Error(`${this.constructor.name} must not be instantiated`)}static on(){if(!_eventDispatcher.interactive)return this;_eventDispatcher.$target.on.apply(_eventDispatcher.$target,[].slice.call(arguments));return this}static one(){if(!_eventDispatcher.interactive)return this;_eventDispatcher.$target.one.apply(_eventDispatcher.$target,[].slice.call(arguments));return this}static off(){if(!_eventDispatcher.interactive)return this;_eventDispatcher.$target.off.apply(_eventDispatcher.$target,[].slice.call(arguments));return this}static trigger(){if(!_eventDispatcher.interactive)return this;_eventDispatcher.$target.trigger.apply(_eventDispatcher.$target,[].slice.call(arguments));return this}static get target(){return _eventDispatcher.target}static set target(value){_eventDispatcher.target=value}static get $target(){return _eventDispatcher.$target}static set $target(value){_eventDispatcher.$target=value}static get interactive(){return _eventDispatcher.interactive}static set interactive(value){_eventDispatcher.interactive=value}}export class DynamicObject{constructor(selector,options={}){this._selector=selector;this._options=options;this._change=new signals.Signal;this._click=new signals.Signal;this._$element=$(this._selector)}get selector(){return this._selector}get $element(){return this._$element}get options(){return this._options}get change(){return this._change}get click(){return this._click}}export class DOMComponent extends EventDispatcher{constructor(selector=null,options={}){super(selector);this._selector=selector;this._options=options;this._$selector=$(selector);this._value=this._$selector.val();this._id=this._$selector.attr("id");this._name=this._$selector.attr("name")||this._$selector.attr("data-name");this._optional=this.$selector.attr("data-optional")==="data-optional";this._required=this.$selector.attr("required")==="required";this.changeCallBack=()=>{};this.$selector.data("instance",this);this.addAttributes(options.attributes)}show(duration=500){this.$selector.fadeIn(duration);return this}hide(duration=500){this.$selector.fadeOut(duration);return this}addAttributes(attributes=null){if(!attributes)return this;let p;for(p in attributes)this.$selector.attr(p,attributes[p]);return this}get instance(){return this.$selector.data("instance")}enable(){this._$selector.removeClass("disabled").removeAttr("disabled");return this}disable(){this._$selector.addClass("disabled").attr("disabled");return this}scrollY(offset=0){this.$selector.scrollTop(this.y+offset);return this}get selector(){return this._selector}get $selector(){return this._$selector}get options(){return this._options}get value(){return this._$selector.val()}set value(value){this._value=value;this._$selector.val(value)}get state(){return this._state}set state(value){this._state=value;this._$selector.removeClass("disabled").removeClass("valid").removeClass("invalid").addClass(value);if(value==="enabled")this.enable();else if(value==="disabled")this.disable()}get id(){return String(this._id||"").replace("#","")}set id(value){this._id=value}get name(){return this._name}set name(value){this._name=value}get interactive(){return super.interactive}set interactive(value){super.interactive=value;this.$selector[value?"removeClass":"addClass"]("no-interaction")}get x(){return this.$selector.offset().left}get y(){return this.$selector.offset().top}get width(){return this.$selector.width()}get height(){return this.$selector.height()}get innerWidth(){return this.$selector.innerWidth()}get innerHeight(){return this.$selector.innerHeight()}get optional(){return this._optional}get required(){return this._required}get outerHTML(){return this.$selector[0].outerHTML}}export class API{constructor(baseURL="/api",headers={},strictResponse=false){this.baseURL=baseURL;this._axios=axios.create({baseURL:baseURL});this._axios.defaults.headers={"Access-Control-Allow-Origin":"*","X-Requested-With":"xmlhttprequest","Content-Type":"application/json; charset=utf-8",...headers};this._strictResponse=strictResponse}async request(method,url,data={}){if(!this._strictResponse)return this._axios.request({method:method,url:url,data:data});try{const response=await this._axios.request({method:method,url:url,data:data});return new HTTPResponse(response)}catch(e){return null}}get(url){return this.request("get",`${this.baseURL}${url}`)}post(url,data){return this.request("post",`${this.baseURL}${url}`,data)}put(url,data){return this.request("put",`${this.baseURL}${url}`,data)}delete(url){return this.request("delete",`${this.baseURL}${url}`)}options(url){return this.request("options",`${this.baseURL}${url}`)}patch(url,data){return this.request("patch",`${this.baseURL}${url}`,data)}head(url){return this.request("head",`${this.baseURL}${url}`)}get headers(){return this._axios.defaults.headers}get axios(){return this._axios}}export class BackOfficeAPI extends API{constructor(){super("")}getPlatformsAndProductsByClient(clientIDS){return this.patch(`/client-transactions/client-data`,{data:clientIDS})}getAuditData=(id,dateStart,dateEnd,columnID)=>{return this.get(`/audit?id=${id}&date-start=${dateStart}&date-end=${dateEnd}&column-id=${columnID}`)}}export class HTTPResponse{constructor(response){this._response=response;this._config=response.config;this._headers=response.headers;this._request=response.request;this._status=this._request.status;this._statusText=this._request.statusText;this._header=response.data.header;this._body=response.data.body;this._validation=this._header.validation;this._validationSuccess=this._validation.success;this._success=this._header.success;this._error=this._header.error}toObject(){return{status:this._status,statusText:this._statusText,header:this._header,body:this._body,validation:this._validation,validationSuccess:this._validationSuccess,success:this._success,error:this._error}}toString(){return`status: ${this._status}, statusText: ${this._statusText}, success: ${this._success}, error: ${this._error}, validation success: ${this._validationSuccess}, header: ${this._header}, body: ${this._body}`}get response(){return this._response}get headers(){return this._headers}get request(){return this._request}get status(){return this._status}get statusText(){return this._statusText}get success(){return this._success}get error(){return this._error}get validation(){return this._validation}get validationSuccess(){return this._validationSuccess}get config(){return this._config}get header(){return this._header}get body(){return this._body}}const SERVICE_CEP_URL=`https://viacep.com.br/ws`;export class CEP{constructor(){}static async getAddress(cep=null){const url=`${SERVICE_CEP_URL}/${cep.replace(/[^0-9]/g,"")}/json/`;if(!Validator.cep(cep)||url===`${SERVICE_CEP_URL}//json/`)return false;const result=await fetch(url);return result.json()}}const SERVICE_RECEITA_FEDERAL_URL=``;export class ReceitaFederal{constructor(){}static getCPF(){}static getCNPJ(){}}export class Input extends DOMComponent{constructor(id,name=null,options={}){super(id,{autoMask:true,forbiddenKeys:[],autoBuild:true,hideValidationMessagesOnFocus:true,validateOnBlur:false,...options});this._id=id;this._name=String(name||id||"").replace("#","");this._isValidationEnabled=true;this._isServerValidationEnabled=true;this._state="idle";this._$parent=this.$selector.closest(this.options.parentSelector||".input-parent");this._api=new API;this._formSchema=0;this._$spinner=this.$parent.find(this.options.spinnerSelector||".input-spinner");this._$label=this.$parent.find("label");this.schema=!isNaN(this.$selector.data("schema"))?this.$selector.data("schema"):-1;this._hasMask=false;this._validateOnInput=false;this._validateOnInputHandler=null;this._bufferValue=$(id).attr("value");this._isCleared=false;this._isRestored=false;this._isBuilt=false;this._dataType="text";this._dataTypeParams={};this._maxLength=0;this._maxLengthBadgeEnabled=false;const $group=this.$selector.parents("[data-form-group]");if($group.length)this.groupName=$($group[0]).attr("data-name");this.hideSpinner(0);this.addAttributes(this.options.attributes);if(this.options.hideValidationMessagesOnFocus)this.$selector.on("keydown mousedown",e=>{this.hideAllValidationMessages()});if(this.options.validateOnBlur)this.$selector.on("blur",e=>{this.validate()});if(this.options.autoBuild||!this.options.hasOwnProperty("autoBuild"))this.build()}async build(){if(this._isBuilt)return this;this._isBuilt=true;this._parsePopOver();this._parseMaxLength();this._parseClientValidation();this._parseServerValidation();this._parseForbiddenKeys();this._parseDataType();await this.update();return this.enableMaxLengthBadge()}_parseClientInfos(){return this}_parseServerInfos(){return this}_parseForbiddenKeys(){this._forbiddenKeys=this.options.forbiddenKeys;if(this._forbiddenKeys&&this._forbiddenKeys.length){this.on("keydown",e=>{if(this._forbiddenKeys.indexOf(e.keyCode||e.which)!==-1){e.preventDefault();e.stopPropagation();return false}})}return this}parseSchema(){if(this.schema!==-1)this[this._formSchema===this._schema?"show":"hide"](0);return this}_parsePopOver(){const content=this.$selector.data("tip");if(content){this._popOver=new PopOver(this.selector,{content:content,trigger:"manual",placement:"top",template:`<div class="popover input-popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>`});this.$selector.on("mouseover click focus",e=>{this._popOver.show()});this.$selector.on("blur mouseout",e=>{this._popOver.hide()})}return this}_parseDataType(){const dataType=this.$selector.data("type").split("(");this._dataType=String(dataType[0]||dataType||"").trim();this._dataTypeParams=String(dataType[1]||"").trim().replace(")","");if(this.options.autoMask&&this._dataType&&this._dataType!=="text")this.mask(this._dataType);return this}_parseMaxLength(){this._maxLength=Number(this.$selector.attr("maxlength")||0);if(!isNaN(this._maxLength)&&this._maxLength>0){this._$maxLengthBadge=this._$parent.find(".maxlength-badge").fadeOut(0);this.on("input",e=>{if(!this._maxLengthBadgeEnabled)return;this.showMaxLengthBadge();clearTimeout(this._badgeTimeOut);this._badgeTimeOut=setTimeout(()=>{this.hideMaxLengthBadge()},1e3)})}return this}enableMaxLengthBadge(){this._maxLengthBadgeEnabled=true;return this}disableMaxLengthBadge(){this._$maxLengthBadge.fadeOut(0);this._maxLengthBadgeEnabled=false;return this}_parseValidationRules(validation){return Validator.parseRulesByAttribute(validation)}_parseClientValidation(){this._validation=[];if(this.$selector.data("validation"))this._validation=this._parseValidationRules(this.$selector.data("validation"));this._$validationContainer=this.$parent.find(".validation-container.client-validation").slideUp(0);return this}_parseServerValidation(){this._serverValidation=[];if(this.$selector.data("server-validation"))this._serverValidation=this._parseValidationRules(this.$selector.data("server-validation"));this._$serverValidationContainer=this.$parent.find(".validation-container.server-validation").slideUp(0);return this}async update(){return this.trigger({type:"input"})}async request(method,url,data=null){const response=await this._api[method](url,data);return response.data}showSpinner(duration=500){this._$spinner.fadeIn(duration);this.disable();return this}hideSpinner(duration=500){this._$spinner.fadeOut(duration);this.enable();return this}show(duration=500){this.$parent.fadeIn(duration);return this}hide(duration=500){this.$parent.fadeOut(duration);return this}enable(){this.$parent.removeClass("disabled").removeAttr("disabled");return this}disable(){this.$parent.addClass("disabled").attr("disabled");this.$selector.blur();return this}focus(){this.scrollY().$selector.focus();return this}mask(name,options={}){this._hasMask=true;return Mask.byName(this.$selector,name,options)}showMaxLengthBadge(duration=500){if(this._maxLength-this.value.length===0)return this;this._$maxLengthBadge.text(`caracteres restantes: ${this._maxLength-this.value.length}`).fadeIn(duration);return this}hideMaxLengthBadge(duration=500){this._$maxLengthBadge.fadeOut(duration);return this}showAllValidationMessages(){return this.showValidationMessages().showServerValidationMessages()}hideAllValidationMessages(){return this.hideValidationMessages().hideServerValidationMessages()}showValidationMessages(){this._$validationContainer.slideDown(500);return this}hideValidationMessages(){this._$validationContainer.slideUp(500);return this}showServerValidationMessages(){this._$serverValidationContainer.slideDown(500);return this}hideServerValidationMessages(){this._$serverValidationContainer.slideUp(500);return this}showInfos(){return this}hideInfos(){return this}showInfo(name){return this}hideInfo(name){return this}validate(){this.hideValidationMessages();if(!this._isValidationEnabled||this.isOptional)return true;const validationResults=[];this._$validationContainer.find(".validation-message").fadeOut(0);for(const rule of this._validation){try{const name=rule.rule,currentValidation=Validator[name](this.value,rule.params);this._$validationContainer.find(`[data-rule="${name}"]`)[currentValidation?"fadeOut":"fadeIn"](0);validationResults.push(currentValidation)}catch(e){log(e);throw new Error(`Validation error, rule: ${rule.rule} not exists`)}}const isValid=validationResults.indexOf(false)===-1;this[isValid?"hideValidationMessages":"showValidationMessages"](500);return isValid}serverValidate(validation){this.hideServerValidationMessages();if(!this._isServerValidationEnabled)return true;const validationResults=[];this._$serverValidationContainer.find(".validation-message").fadeOut(0);for(const rule of validation){const name=rule.rule,currentValidation=rule.result;this._$serverValidationContainer.find(`[data-rule="${name}"]`)[currentValidation?"fadeOut":"fadeIn"](0);validationResults.push(currentValidation)}const isValid=validationResults.indexOf(false)===-1;this[isValid?"hideServerValidationMessages":"showServerValidationMessages"](500);return isValid}enableAllValidation(restore=true){return this.enableValidation(restore).enableServerValidation(restore)}disableAllValidation(clear=true){return this.disableValidation(clear).disableServerValidation(clear)}enableValidation(restore=true){if(restore)this.restore();this._isValidationEnabled=true;return this}disableValidation(clear=true){if(clear)this.clear();this._isValidationEnabled=false;return this}enableServerValidation(restore=true){if(restore)this.restore();this._isServerValidationEnabled=true;return this}disableServerValidation(clear=true){if(clear)this.clear();this._isServerValidationEnabled=false;return this}restore(){if(this._isRestored)return this;this._isRestored=true;this.value=this._bufferValue||"";return this}clear(){if(this._isCleared)return this;this._isCleared=true;this._bufferValue=this.value;this.value="";return this}get value(){return super.value}set value(value){super.value=value?value.substring(0,this._maxLength||value.length):value}get $parent(){return this._$parent}get dataType(){return this._dataType}get formSchema(){return this._formSchema}set formSchema(value){this._formSchema=value;this.parseSchema()}get schema(){return this._schema}set schema(value){this._schema=value;this.parseSchema()}set interactive(value){super.interactive=value;this.$parent[value?"removeClass":"addClass"]("no-interaction")}get groupName(){return this.$selector.attr("data-group")}set groupName(value){this._groupName=value;this.$selector.attr("data-group",value)}get $label(){return this._$label}set $label(value){this._$label=value}get hasMask(){return this._hasMask}get unformattedValue(){if(!this._hasMask)return this.value;return this.$selector.cleanVal()}get isValidationEnabled(){return this._isValidationEnabled}get isServerValidationEnabled(){return this._isServerValidationEnabled}get validateOnInput(){return this._validateOnInput}set validateOnInput(value){if(this._validateOnInputHandler&&value)return;else{this._validateOnInputHandler=e=>{this.validate()};this.on("keydown input blur focus",this._validateOnInputHandler)}if(!this._validateOnInputHandler&&!value)return;else this.off("keydown input blur focus",this._validateOnInputHandler);this._validateOnInput=value}get isOptional(){const isRequired=this.$selector.attr("required")==="required",isEmpty=this.value===""||!String(this.value||"").length,hasDefaultValue=this.value===this.$selector.attr("value")||this.value===this.$selector.attr("data-value");return!isRequired&&(isEmpty||hasDefaultValue)}get bufferValue(){return this._bufferValue}get isCleared(){return this._isCleared}get isRestored(){return this._isRestored}get api(){return this._api}get $spinner(){return this._$spinner}get isBuilt(){return this._isBuilt}get dataTypeParams(){return this._dataTypeParams}get maxLength(){return this._maxLength}}export class InputNumber extends Input{constructor(id,name=null,options={}){super(id,name,options);this.on("keydown",e=>{const code=e.keyCode||e.which,key=String.fromCharCode(code);if(!Validator.number(key)&&NUMBERS_AND_SIGNS.indexOf(code)===-1){if(!ASC2.checkCutCopyAndPaste(e)&&!ASC2.checkSelection(e)){e.preventDefault();e.stopPropagation();return false}}})}}export class AjaxForm extends DOMComponent{constructor(id,options={}){super(id,{strictResponse:true,inputOptions:{},...options});this._inputs=[];this._inputsObject={};this._groups=[];this._action=this.$selector.attr("action");this._method=this.$selector.attr("method");this._api=new API("",{},options.strictResponse);this._isSubmitting=false;this._feedBackType=this.$selector.attr("data-feed-back-type")||"";this._clearAfterCreate=this.$selector.attr("data-clear-after-create")==="data-clear-after-create";this._clearAfterUpdate=this.$selector.attr("data-clear-after-update")==="data-clear-after-update";this._isGET=this._method==="get";this._isPOST=this._method==="post";this._isPUT=this._method==="put";this._isDELETE=this._method==="delete";this._isPATCH=this._method==="patch";this._isHEAD=this._method==="head";this._isOPTIONS=this._method==="options";this._messagesTop=null;this.$selector.addClass("clearfix");this._$htmlBody=$("html, body");this._createByType();this._parseInfos();this._submit=new Button(this.$selector.find('button[type="submit"]'));this.$selector.on("submit",async e=>{e.preventDefault();await this.submit()});this.schema=this.$selector.data("schema")||0;if(this._inputs.length)this._inputs[0].focus()}_parseInfos(){const id="#"+$($(`[data-target="#${this.id}"]`)[0]).attr("id");if($(id).length)this._messagesTop=new FormAlerts(id);return this}_createByType(){log("Form inputs:");log("--------------------------------------------------------");this.$selector.find("[data-form-input]").each((i,e)=>{const $element=$(e),id=e.id,name=e.name,idOrName=id||name;let InputClass=Input,options=this.options.inputOptions?this.options.inputOptions[idOrName]||{}:{};switch($element.attr("data-type")){case"password":InputClass=InputPassword;break;case"radio":InputClass=InputRadio;break;case"checkbox":InputClass=InputCheckBox;break;case"email":InputClass=InputEmail;break;case"file":InputClass=InputFile;break;case"url":InputClass=InputURL;break;case"number":InputClass=InputNumber;break;case"float":InputClass=InputFloat;break;case"double":InputClass=InputDouble;break;case"currency":InputClass=InputCurrency;break;case"phone":InputClass=InputPhone;break;case"select":InputClass=Select;break;case"select2":InputClass=Select2;break;case"cpf":InputClass=InputCPF;break;case"cnpj":InputClass=InputCNPJ;break;case"cep":if($element.is("select"))InputClass=Select;else InputClass=InputCEP;break}if(InputClass){const className=String(InputClass).split("{")[0].trim().replace("class","").split("extends")[0].trim(),instance=new InputClass(`#${idOrName}`,name,options);log(`${idOrName}: [${className}]`,options);this._inputs.push(instance);this._inputsObject[idOrName]=instance}});log("--------------------------------------------------------");return this}async submit(){if(this._isSubmitting)return;this._isSubmitting=true;if(!this.validate()){this._isSubmitting=false;this.enableInputs().toast(SweetAlert2.MESSAGES.validationErrorText);return}this.disableInputs().hideAllValidationMessages();this._submit.showSpinner();SweetAlert2.showLoading();log("form value");log(this.value);const isFeedBackModal=this._feedBackType==="modal",serverErrorTitle=SweetAlert2.MESSAGES.serverErrorTitle,serverErrorText=SweetAlert2.MESSAGES.serverErrorText,serverErrorOptions={showConfirmButton:false,showCloseButton:true,showCancelButton:false};let errorInfo="";const response=await this._api[this._method](this._action,this.value),header=response.header||{status:{code:500}},success=response.success,validation=response.validation.result,hasValidation=validation&&Object.keys(validation).length,body=response.body,exception=body?body.exception:null,messages=body?body.formMessages:null;log("success",success);log("validation:",hasValidation,validation);log("body",body);log("messages",messages);log("exception",exception);if(messages)this._messagesTop.addMessages(messages);try{if(body&&exception&&exception.errorInfo)errorInfo=`<pre class="error-description">${exception.errorInfo.join("\n")}</pre>`;if(success){if(isFeedBackModal)this.alertSuccess(null,null,{},()=>{this._$htmlBody.animate({scrollTop:0},500)}).trigger({type:"success",success:true,error:false,response:response});if(this._clearAfterCreate&&this._method==="post"||this._clearAfterUpdate&&this._method==="put")this.clear().trigger({type:"clear"})}else{if(hasValidation)if(!this.serverValidate(validation))this.toast(SweetAlert2.MESSAGES.validationErrorText);if(!hasValidation&&isFeedBackModal)this.alertError().trigger({type:"error",success:false,error:true,response:response})}if(header.status.code===500&&isFeedBackModal)this.alertError(serverErrorTitle,`${serverErrorText}${errorInfo}`,serverErrorOptions).trigger({type:"error",success:false,error:true})}catch(e){if(isFeedBackModal)this.alertError(serverErrorTitle,`${serverErrorText}${errorInfo}`,serverErrorOptions).trigger({type:"error",success:false,error:true})}this.enableInputs();this._submit.showText();this._isSubmitting=false;SweetAlert2.hideLoading();this.trigger({type:"response"});return this}toast(message,options={position:"bottom-end",timer:7770},completeHandler=result=>{return result}){SweetAlert2.toastValidationError(message,options,completeHandler);return this}alert(icon,title,text,options={},completeHandler=result=>{return result}){SweetAlert2.alert(icon,title,text,options,completeHandler);return this}alertSuccess(title=null,message=null,options={},completeHandler=result=>{return result}){SweetAlert2.alertSuccess(title||SweetAlert2.MESSAGES.successTitle,message||SweetAlert2.MESSAGES[this._isPOST?"createSuccessText":"updateSuccessText"],options,completeHandler);return this}alertError(title=null,message=null,options={},completeHandler=result=>{return result}){SweetAlert2.alertError(title||SweetAlert2.MESSAGES.errorTitle,message||SweetAlert2.MESSAGES[this._isPOST?"createErrorText":"updateErrorText"],options,completeHandler);return this}showAllValidationMessages(){this._inputs.forEach(input=>input.showAllValidationMessages());return this}hideAllValidationMessages(){this._inputs.forEach(input=>input.hideAllValidationMessages());return this}clear(){this._inputs.forEach(input=>input.clear());this.enableInputs();return this}enable(){this.enableInputs().enableSubmit();return super.enable()}disable(){this.disableInputs().disableSubmit();return super.disable()}enableInputs(){this._inputs.forEach(input=>input.enable());return this}disableInputs(){this._inputs.forEach(input=>input.disable());return this}enableSubmit(){this._submit.enable();return this}disableSubmit(){this._submit.disable();return this}validate(){let isMoved=false;return this._inputs.map(input=>{const validation=input.validate();if(!isMoved&&!validation){isMoved=true;input.focus()}return validation}).indexOf(false)===-1}serverValidate(validation){return this._inputs.map(input=>{return input.serverValidate(validation[input.id.replace("input-","")])}).indexOf(false)===-1}getInputByID(id){let i;const total=this._inputs.length;for(i=0;i<total;++i)if(this._inputs[i].id===id)return this._inputs[i];return null}getGroupByID(id){let i;const total=this._groups.length;for(i=0;i<total;++i)if(this._groups[i].id===id)return this._groups[i];return null}getInputByName(name){let i;const total=this._inputs.length;for(i=0;i<total;++i)if(this._inputs[i].name===name)return this._inputs[i];return null}get action(){return this._action}set action(value){this._action=value;this.$selector.attr("action",value)}get method(){return this._method}set method(value){this._method=value;this.$selector.attr("method",value)}get inputs(){return this._inputs}get data(){return this._inputs.map(input=>{return input.value})}set data(value){let i;const total=value.length;for(i=0;i<total;++i)this._inputs[i].value=value[i]}get value(){const result={};this._inputs.forEach((e,i)=>{result[(e.id||e.name||"").replace("input-","").replace("#","")]=e.value});return result}set value(value){let p;for(p in value){const input=this._inputsObject["input-"+p];input.value=value[p];input.update()}}get schema(){return this._schema}set schema(value){this._schema=value;this.$selector.attr("data-schema",value);this._inputs.forEach(input=>input.formSchema=value)}get isSubmitting(){return this._isSubmitting}get isGET(){return this._isGET}get isPOST(){return this._isPOST}get isPUT(){return this._isPUT}get isDELETE(){return this._isDELETE}get isPATCH(){return this._isPATCH}get isHEAD(){return this._isHEAD}get isOPTIONS(){return this._isOPTIONS}}export class Alert extends DOMComponent{constructor(id,options={}){super(id,options)}}export class Button extends DOMComponent{constructor(id,options=[]){super(id,options);this._$spanText=this.$selector.find(".button-content");this._$spinner=this.$selector.find(".spinner").animate({opacity:0},0)}showSpinner(duration=500){if(this.$selector.innerHeight()>this._$spinner.innerHeight())this._$spinner.css({top:this.$selector.innerHeight()-this._$spinner.innerHeight()>>1});this._$spanText.animate({opacity:0},duration);this._$spinner.animate({opacity:1},duration);this.$selector.attr("data-state","spinner");return this}hideSpinner(duration=500){this._$spinner.animate({opacity:0},duration);this._$spanText.animate({opacity:1},duration);this.$selector.removeAttr("data-spinner");return this}showText(duration=500){this._$spanText.animate({opacity:1},duration);this._$spinner.animate({opacity:0},duration);this.$selector.attr("data-state","text");return this}hideText(duration=500){this._$spanText.animate({opacity:0},duration);return this}}export class CRUD{constructor(options){}}$.fn.dataTable.ext.errMode="none";const DEFAULT_VALUE="-";const setupColumns=(columns=[])=>{let i;const total=columns.length,config=[];for(i=0;i<total;++i){const column=columns[i],typeData={...{prefix:"",suffix:""},...column.typeData||{}},columnConfig={data:column.name,render:data=>{return data}},prefix=typeData.prefix||"",suffix=typeData.suffix||"";if(!column.data)column.data=column.name;switch(column.type){case"name":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return`<span class="name">${prefix}${value}${suffix}</span>`};break;case"email":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return`<a href="mailto:${value}">${prefix}${value}${suffix}</a>`};break;case"document":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;if(value.length===11)return prefix+StringUtil.formatCPF(value)+suffix;if(value.length===14)return prefix+StringUtil.formatCNPJ(value)+suffix;return value};break;case"cpf":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return prefix+StringUtil.formatCPF(value)+suffix};break;case"cnpj":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return prefix+StringUtil.formatCNPJ(value)+suffix};break;case"date":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return prefix+StringUtil.dateToPTBRFormat(value)+suffix};break;case"list":columnConfig.render=data=>{return prefix+(data||DEFAULT_VALUE)+suffix};break;case"number":columnConfig.render=data=>{return prefix+(Number(data)||DEFAULT_VALUE)+suffix};break;case"float":columnConfig.render=data=>{if(!data)return DEFAULT_VALUE;return prefix+parseFloat(data).toFixed(typeData.decimals||2)+suffix};break;case"currency":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return prefix+StringUtil.formatCurrency(value)+suffix};break;case"object":columnConfig.render=data=>{const value=data||"";if(!value)return DEFAULT_VALUE;return'<span class="status">'+prefix+(typeData[value]||value)+suffix+"</span>"};break;default:columnConfig.render=data=>{if(!data)return DEFAULT_VALUE;return prefix+data+suffix};break}config.push(columnConfig)}return config};const requestData=async()=>{_exportTimeInterval=setInterval(()=>{++_exportTime;log(`time elapsed: ${_exportTime} seconds`)},1e3);showLoader();const response=await fetch(`${URL}?`+$.param({...getURLParams(),...{all:true,test:false,result_type:"values"}}));return response.json()};const exportAll=async type=>{const data=await requestData();hideLoader();clearInterval(_exportTimeInterval);if(type==="excel")exportExcel(null,null,data);console.log(`Total time to export: ${_exportTime} seconds`)};const exportExcel=(name,fileName,data,meta)=>{const wb=XLSX.utils.book_new();wb.Props={Title:"Report",Subject:"Report",Author:"XGrow",CreatedDate:(new Date).getDate()};wb.SheetNames.push("Test Sheet");var ws_data=data.data;var ws=XLSX.utils.aoa_to_sheet(ws_data);wb.Sheets["Test Sheet"]=ws;var wbout=XLSX.write(wb,{bookType:"xlsx",type:"binary"});saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}),"relatorio.xlsx")};function s2ab(s){var buf=new ArrayBuffer(s.length);var view=new Uint8Array(buf);for(var i=0;i<s.length;i++)view[i]=s.charCodeAt(i)&255;return buf}const exportOptions={exportOptions:{modifier:{page:"all",search:"none"}}};const initHandler=()=>{};const updateSort=e=>{if(e&&e.currentTarget){const index=$(e.currentTarget).data("index");const existentIndex=_order.map(x=>x[0]).indexOf(index);if(existentIndex>-1){++_order[existentIndex][2];if(_order[existentIndex][2]===1)_order[existentIndex][1]="asc";else _order.splice(existentIndex,1)}else{_order.unshift([index,"desc",0])}}let counter=0;$(`.badge-sort`).addClass("hidden");_order.forEach((e,i)=>{$(`.badge-sort[data-index=${_order[i][0]}]`).text(++counter).removeClass("hidden")});if(e&&e.currentTarget)$dataTable.order(_order)};const _order=[];$(document).on("click",".sort-column",e=>{e.preventDefault();e.stopImmediatePropagation();e.stopPropagation();updateSort(e)});const lengthMenu=[[100,250,500,1e3,2500,5e3,1e4],[100,250,500,1e3,2500,5e3,1e4]];export class DataTable extends DOMComponent{constructor(id,options={}){super(id,{...{getURLParams:()=>{return{}}},...options});this._$tableContainer=this.$selector.closest(".table-container");this._$loader=this._$tableContainer.find(".table-loader");const COLUMNS_DATA=options.columns;delete options.columns;this._$dataTable=$(id).on("init.dt",(e,settings,data)=>{console.log(`DataTables ${id} inited`)}).on("preXhr.dt",(e,settings,data)=>{this.showLoader()}).on("xhr.dt",(e,settings,data)=>{this.hideLoader()}).on("order.dt",(e,settings,data)=>{}).on("error.dt",(e,settings,techNote,message)=>{console.log(`DataTables ${id} error`);console.warn(message)}).DataTable({...{orderMulti:true,columnDefs:[{defaultContent:"-",targets:"_all"}],order:[],columns:setupColumns(COLUMNS_DATA),buttons:[],language:{url:"//cdn.datatables.net/plug-ins/1.10.20/i18n/Portuguese-Brasil.json"},ajax:{url:this.options.url,data:data=>{const vars={...{itemsPerPage:Number(this._$dataTable?this._$dataTable.page.len():lengthMenu[0]),page:Number(this._$dataTable?this._$dataTable.page():0)+1},...{...this.options.getURLParams(),...data}};return vars}},searching:false,processing:false,serverSide:true,searchDelay:1500,lengthMenu:lengthMenu},...options||{}})}showLoader(){this._$loader.fadeIn(500);return this}hideLoader(){this._$loader.fadeOut(500);return this}show(reload=true,completeCallBack=()=>{}){if(reload)this.reloadRequest(()=>{this.hideLoader();completeCallBack()});this.$selector.closest(".table-container").removeClass("hidden").removeAttr("hidden");return this}hide(){this.abortRequest();this.$selector.closest(".table-container").addClass("hidden").attr("hidden","hidden");return this}reloadRequest(completeCallBack=()=>{}){this._$dataTable.ajax.reload(completeCallBack);return this}abortRequest(){try{this._$dataTable.settings()[0].jqXHR.abort()}catch(e){}return this}}export class DatePicker extends DOMComponent{constructor(selector,options={}){super(selector,options);this._$datePicker=DatePicker.create(selector,options)}get value(){return this._$datePicker.val()}static create(selector=".datepicker",options={}){return $(selector).datepicker({...{todayBtn:true,clearBtn:true,language:"pt-BR",multidate:false,calendarWeeks:true,autoclose:true,todayHighlight:true,zIndexOffset:777},...options})}}const MESSAGE={confirm:"confirmar",deny:"negar",cancel:"cancelar",close:"fechar"},ICON={SUCCESS:"success",ERROR:"error",WARNING:"warning",INFO:"info",QUESTION:"question"},TITLE={SUCCESS:`<h1>sucesso!</h1>`,ERROR:`<h1>erro!</h1>`,WARNING:`<h1>aviso!</h1>`,INFO:`<h1>informação!</h1>`,QUESTION:`<h1>pergunta!</h1>`},DEFAULTS={showConfirmButton:true,showCloseButton:true,showCancelButton:true,showDenyButton:true,allowEscapeKey:true,allowEnterKey:true,backdrop:true,allowOutsideClick:true,confirmButtonText:MESSAGE.confirm,denyButtonText:MESSAGE.deny,cancelButtonText:MESSAGE.cancel},ALERT_DEFAULTS={...DEFAULTS,showConfirmButton:true,showCloseButton:true,showCancelButton:false,showDenyButton:false},PIN_ALERT_DEFAULTS={...ALERT_DEFAULTS,showConfirmButton:false,showCloseButton:false,showCancelButton:false,showDenyButton:false,allowEscapeKey:false,allowEnterKey:false,backdrop:true,allowOutsideClick:false};export class Dialog extends StaticEventDispatcher{constructor(){super()}static alert(options={}){return Swal.fire({...ALERT_DEFAULTS,...options})}static alertSuccess(options={}){return Dialog.alert({icon:ICON.SUCCESS,title:TITLE.SUCCESS,...options})}static alertError(options={}){return Dialog.alert({icon:ICON.ERROR,title:TITLE.ERROR,...options})}static alertWarning(options={}){return Dialog.alert({icon:ICON.WARNING,title:TITLE.WARNING,...options})}static alertInfo(options={}){return Dialog.alert({icon:ICON.INFO,title:TITLE.INFO,...options})}static alertQuestion(options={}){return Dialog.alert({icon:ICON.QUESTION,title:TITLE.QUESTION,...options})}static pinAlertSuccess(options={}){return Dialog.alert({icon:ICON.SUCCESS,title:TITLE.SUCCESS,...options,...PIN_ALERT_DEFAULTS})}static pinAlertError(options={}){return Dialog.alert({icon:ICON.ERROR,title:TITLE.ERROR,...options,...PIN_ALERT_DEFAULTS})}static pinAlertWarning(options={}){return Dialog.alert({icon:ICON.WARNING,title:TITLE.WARNING,...options,...PIN_ALERT_DEFAULTS})}static pinAlertInfo(options={}){return Dialog.alert({icon:ICON.INFO,title:TITLE.INFO,...options,...PIN_ALERT_DEFAULTS})}static pinAlertQuestion(options={}){return Dialog.alert({icon:ICON.QUESTION,title:TITLE.QUESTION,...options,...PIN_ALERT_DEFAULTS})}}export class Form extends DOMComponent{constructor(id,options={}){super(id,options);this._autoSubmit=options.autoSubmit||false;this._state="enabled";this._$form=$(id).on("submit",e=>{e.preventDefault();e.stopPropagation();this.submit()});this._$inputs={};this._$form.find(`[data-form-input]`).each((i,e)=>{const $input=$(e);this._$inputs[$input.attr("id").replace("input-","")]=$input});this._$submit=this._$form.find('[type="submit"]');this._$form.find(".input-validation-message").removeAttr("hidden").fadeOut(0);console.log(this._$form.attr("id"));console.log(Object.keys(this._$inputs))}showSubmitSpinner(){this._$form.find(".submit-spinner").removeClass("hidden");this._$form.find(".submit-content").addClass("hidden")}hideSubmitSpinner(){this._$form.find(".submit-spinner").addClass("hidden");this._$form.find(".submit-content").removeClass("hidden")}enable(){this.hideSubmitSpinner();this._$form.removeClass("disabled")}disable(){this._$form.addClass("disabled")}awaiting(){this.disable();this.showSubmitSpinner()}validate(){let p,validation=[];for(p in this._$inputs){const $input=$(this._$inputs[p]),required=$input[0].hasAttribute("required"),name=$input.attr("name"),value=$input.val();if(required&&!value){this._$form.find(`[data-name="${name}"]`).fadeIn(500);validation.push(false)}else{this._$form.find(`[data-name="${name}"]`).fadeOut(500);validation.push(true)}}console.log("validation",validation,validation.indexOf(false));return validation.indexOf(false)===-1}submit(){if(this.options.validate&&!this.validate())return;if(!this._autoSubmit){$(window).trigger({type:"form:submit",value:this.value});return}}get value(){let p,value={};for(p in this._$inputs)value[p]=this._$inputs[p].val();return value}get inputs(){return this._$inputs}get state(){return this._state}set state(state){this._state=state;if(state==="enabled")this.enable();else if(state==="disabled")this.disable();else if(state==="awaiting")this.awaiting()}}const TEMPLATES={success:`<li class="success" data-type="success" data-name="%s" data-params="%s" data-fixed="%s" data-alert><i class="fas fa-check"></i> %s</li>`,warning:`<li class="warning" data-type="warning" data-name="%s" data-params="%s" data-fixed="%s" data-alert><i class="fas fa-times"></i> %s</li>`,info:`<li class="info" data-type="info" data-name="%s" data-params="%s" data-fixed="%s" data-alert><i class="fas fa-info"></i> %s</li>`};export class FormAlerts extends DOMComponent{constructor(id=null,options={}){super(id,options);this._$messages={};this._$list=this.$selector.find("ul");this.hide(0);this._build();this.show()}_build(){this.$selector.find("[data-alert]").each((i,e)=>{const $alert=$(e);this._$messages[$alert.attr("data-name")]=$alert});return this}show(duration=500){this.$selector.slideDown(duration);return this}hide(duration=500){this.$selector.slideUp(duration);return this}addMessages(messages){let p;for(p in messages)this.addMessage(p,messages[p]);log("this._$messages",this._$messages);return this}addMessage(name,data){if(this._$messages[name])this.removeMessage(name);const{type,message,fixed,params}=data;const html=StringUtil.vsprintf(TEMPLATES[type],[name,params,fixed?1:0,StringUtil.vsprintf(message,parseParams(params))]);this._$messages[name]=$(html).prependTo(this._$list);return this}removeMessage(name){this._$messages[name].remove();delete this._$messages[name];return this}}const parseParams=(params=null)=>{return!params?[]:String(params||"").split("|").map((e,i)=>{return String(e||"").trim()})};export class IconButton extends DOMComponent{constructor(icon0,icon1){super();this._isSwitched=false;this._$icon0=$(icon0).css("cursor","pointer");this._$icon1=$(icon1).css("cursor","pointer").animate({opacity:0},0);const clickHandler=e=>{const duration=500;if(!this._isSwitched){this._$icon0.animate({opacity:0},duration);this._$icon1.animate({opacity:1},duration)}else{this._$icon0.animate({opacity:1},duration);this._$icon1.animate({opacity:0},duration)}this._isSwitched=!this._isSwitched;this.changeCallBack()};this._$icon0.parent().css("min-width",this._$icon0.parent().width()).css("cursor","pointer").on("click",clickHandler)}}const FRAGMENTS_MAP={logradouro:"address",bairro:"district",localidade:"city",uf:"state"};export class InputCEP extends InputNumber{constructor(id,name=null,options={}){super(id,name,{...options,...{autoMask:false}});this._fragments={};let p;if(!this.$selector.attr("data-cep-input")){this._isCepInput=true;$(`[data-cep-input="${this.id}"]`).each((i,e)=>{const $element=$(e);this._fragments[$element.attr("data-fragment")]=$element});this.on("keyup input",async e=>{await this.requestData()});this.mask(this.dataType)}else{this._isCepInput=false;for(p in this._fragments)this._fragments[p].val("")}}async update(){await this.requestData();return super.update()}async requestData(){let p;if(this.value==="."||this.value==="-"||this.value===".-"){this.value="";return false}const length=this.value.indexOf(".")>-1||this.value.indexOf("-")>-1?10:8;if(this.value.length===length){this.showSpinner();const cepResult=await CEP.getAddress(this.value);if(cepResult){for(p in cepResult)if(this._fragments[FRAGMENTS_MAP[p]])this._fragments[FRAGMENTS_MAP[p]].val(cepResult[p]);this.hideSpinner();if(Object.keys(cepResult).length&&this._fragments["number"])this._fragments["number"].focus()}else{this._clearInputs();this.hideSpinner()}}else this._clearInputs();return this}_clearInputs(){let p;for(p in this._fragments)this._fragments[p].val("");this.hideSpinner();return this}}export class InputCheckBox extends Input{constructor(id,name=null,options={}){super(id,name,{...{autoMask:false},...options});this.value=Cast.boolean(this.$selector.attr("value"))||this.$selector.attr("checked")==="checked";this.on("click",e=>{this.toggle()})}toggle(){if(this.checked)this.uncheck();else this.check();return this}check(){this.$selector.attr("checked","checked").attr("value","1");this.parseSchema();return this}uncheck(){this.$selector.removeAttr("checked").attr("value","0");this.parseSchema();return this}get checked(){return this.$selector.attr("checked")==="checked"||this.$selector.attr("value")==="1"}get value(){return this.checked}set value(value){this._value=Cast.boolean(value);if(this._value)this.check();else this.uncheck()}}export class InputCNPJ extends Input{constructor(id,name=null,options={}){super(id,name,options);this.on("input change",e=>{if(this.value==="."||this.value==="-"||this.value===".-"||this.value==="../-"){this.value="";return false}})}}export class InputCPF extends Input{constructor(id,name=null,options={}){super(id,name,options);this.on("input change",e=>{if(this.value==="."||this.value==="-"||this.value===".-"||this.value==="/-"||this.value==="./-"){this.value="";return false}})}}export class InputCurrency extends Input{constructor(id,name=null,options={}){super(id,name,options);this.$selector.attr("data-validation","currency").attr("data-mask","currency")}}export class InputDouble extends InputNumber{constructor(id,name=null,options={}){super(id,name,options);this._punctuation=this.$selector.attr("data-punctuation")||".";this._decimals=Number(this.$selector.attr("data-decimals"))||2;this.on("keydown input",e=>{this.value=e.target.value});if(this.value&&this.maxLength-(this._decimals+1)>0){this.value+=this._punctuation+Array(this._decimals).fill("0").join("")}this.$selector.mask(NumberUtil.format(this.maxLength,this._decimals,this._punctuation),{reverse:true})}}export class InputEmail extends Input{constructor(id,name=null,options={}){super(id,name,options)}}export class InputFile extends Input{constructor(id,name=null,options={}){super(id,name,options)}}export class InputFloat extends InputNumber{constructor(id,name=null,options={}){super(id,name,options);this._punctuation=this.$selector.attr("data-punctuation");this._decimals=this.$selector.attr("data-decimals")}}const GROUPS={};export class InputGroup extends DOMComponent{constructor(id,name,options={},inputs=[]){super(id,options);this._name=name;this._selector=name;this._$selector=$(`[data-name="${name}"]`);this._$inputs=inputs.length?inputs:this._$selector.find(`[data-form-input]`);this._group=this.$selector.data("name");GROUPS[this._group]=this;const clickHandler=e=>{e.stopImmediatePropagation();e.stopPropagation();this.value=$(e.target).val()||$(e.currentTarget).val()};this._$inputs.forEach((e,i)=>{$(e).attr("name",`${this._name}[]`).on("change",clickHandler)});this._options=options}static get(name){return GROUPS[name]}select(input){const inputs=GROUPS[input.groupName].inputs,indexOf=inputs.indexOf(input);inputs.forEach((e,i)=>{log("InputGroup.uncheck",i);e.uncheck()});log("InputGroup.check",indexOf);if(indexOf>-1)inputs[indexOf].check();return this}get options(){return this._options}get $selector(){return this._$selector}get inputs(){return this._$inputs}get group(){return this._group}set group(value){this._group=value}}export class InputPassword extends Input{constructor(id,name=null,options={}){super(id,name,options);this._iconButton=new IconButton(this.$parent.find(".fa-eye"),this.$parent.find(".fa-eye-slash"));this._iconButton.changeCallBack=e=>{this.$selector.attr("type",this.$selector.attr("type")==="text"?"password":"text")}}}export class InputPhone extends Input{constructor(id,name=null,options={}){super(id,name,options);this.$selector.attr("data-validation","phone").attr("data-mask","phone")}}export class InputRadio extends Input{constructor(id,name=null,options={}){super(id,name,{...{autoMask:false},...options});this.$label.on("click",e=>{e.preventDefault();e.stopPropagation();$(`[name="${this.name}"]`).removeAttr("checked");this.$selector.attr("checked","checked").trigger({type:"click"})});this.on("mousedown",e=>{$(`[name="${this.name}"]`).removeAttr("checked");this.$selector.attr("checked","checked")});if(this.checked)this.trigger({type:"click"})}toggle(){if(this.checked)this.uncheck();else this.check();return this}check(){this.$selector.attr("checked","checked");this.parseSchema();return this}uncheck(){this.$selector.removeAttr("checked");this.parseSchema();return this}get checked(){return this.$selector.attr("checked")==="checked"}get value(){return this.checked}set value(value){if(value)this.check();else this.uncheck()}}export class InputURL extends Input{constructor(id,name=null,options={}){super(id,name,options)}get value(){return String(super.value||"").replace("https://","").replace("http://","").replace("www.","")}set value(value){super.value=value}}const $loader=$('<div id="report-loader"><div class="loader-container"><div class="loader"></div></div></div>'),$body=$("body");export class Loader{static create(){$body.removeClass("no-interaction").append($loader.fadeOut(0))}static show(duration=500){$body.addClass("no-interaction");$loader.fadeIn(duration)}static hide(duration=500){$body.removeClass("no-interaction");$loader.fadeOut(duration)}}export class PopOver extends DOMComponent{constructor(selector=null,options={}){super(selector,options);this._$popOver=$(selector).popover(options)}show(){this._$popOver.popover("show");return this}hide(){this._$popOver.popover("hide");return this}toggle(){this._$popOver.popover("toggle");return this}dispose(){this._$popOver.popover("dispose");return this}enable(){this._$popOver.popover("enable");return this}disable(){this._$popOver.popover("disable");return this}toggleEnabled(){this._$popOver.popover("toggleEnabled");return this}update(){this._$popOver.popover("update");return this}static create(selector,options={}){return $(selector).popover(options)}}export class Select extends Input{constructor(id,name=null,options={}){super(id,name,{...{autoMask:false},...options});this._multiple=this.$selector.attr("multiple")==="multiple";if(this.$selector.attr("value"))this.value=this.$selector.attr("value")}get value(){return this.$selector.val()}set value(value){this.$selector.val(value).change()}get multiple(){return this._multiple}}export class Select2 extends Select{constructor(selector,options={}){super(selector,{minimumResultsForSearch:-1,autoBuild:false,...options});this._$select2=this.$selector.addClass("select2-fix").select2(this.options);this.build()}get value(){return this.ids}set value(value){if(this.multiple)this.$selector.val(String(value||"").split("|")).trigger("change");else this.$selector.val(value).trigger("change")}clear(){if(this.multiple)this.$selector.val(null).trigger("change");else this.$selector.select2().empty().select2(this.options);return this}get data(){return this._$selector.select2("data")}get $select2(){return this._$select2}get ids(){return this.data.map(selection=>selection.id||null)}get labels(){return this.data.map(selection=>selection.text||null)}get selected(){return this.data.filter(selection=>selection.selected===true)}}const ICONS={SUCCESS:"success",ERROR:"error",WARNING:"warning",INFO:"info",QUESTION:"question"};const MESSAGES={successTitle:"<h3>Sucesso</h3>",errorTitle:"<h3>Erro</h3>",serverErrorTitle:"<h3>Erro de servidor</h3>",createSuccessText:"<p>Registro criado com sucesso!</p>",updateSuccessText:"<p>Registro atualizado com sucesso!</p>",createErrorText:"<p>Falha ao criar o registro, tente novamente mais tarde!</p>",updateErrorText:"<p>Falha ao atualizar o registro, tente novamente mais tarde!</p>",validationErrorText:"<p>O formulário possui erro (s), favor corrigi-lo (s) antes de prosseguir.</p>",requestErrorText:"<p>Erro de servidor, tente novamente mais tarde!</p>",sendingRequestText:"<p>Enviando sua solicitação, por favor aguarde...</p>",serverErrorText:"<p>Favor informar à equipe de desenvolvedores.</p>",warningTitle:"<p>Aviso</p>"};const COLOR_OPTIONS={iconColor:"white",customClass:{popup:"colored-toast"}};export class SweetAlert2{constructor(){throw new Error("SweetAlert2 must not be instantiated")}static showLoading(text=SweetAlert2.MESSAGES.sendingRequestText,completeHandler=()=>{}){return Swal.fire({html:text,didOpen:()=>{Swal.showLoading()},willClose:()=>{Swal.hideLoading()},didClose:()=>{completeHandler()},icon:"info",showConfirmButton:false,allowOutsideClick:false,allowEscapeKey:false})}static hideLoading(){return Swal.hideLoading()}static alert(icon,title,html,options={},completeHandler=()=>{}){return Swal.fire({...options,...{icon:icon,title:title,html:html,didClose:()=>{completeHandler()}}})}static alertSuccess(title=MESSAGES.successTitle,html=MESSAGES.createSuccessText,options={},completeHandler=()=>{}){return SweetAlert2.alert("success",title,html,options,completeHandler)}static alertWarning(title=MESSAGES.warningTitle,html="",options={},completeHandler=()=>{}){return SweetAlert2.alert("error",title,html,options,completeHandler,completeHandler)}static alertError(title=MESSAGES.errorTitle,html=MESSAGES.createErrorText,options={},completeHandler=()=>{}){return SweetAlert2.alert("error",title,html,options,completeHandler,completeHandler)}static toast(icon,title,options={},completeHandler=()=>{}){return Swal.mixin({toast:true,position:"bottom-end",timer:5e3,timerProgressBar:true,animation:true,showConfirmButton:false,showCloseButton:true,showCancelButton:false,allowEscapeKey:true,allowOutsideClick:true,didClose:()=>{completeHandler()},didOpen:toast=>{toast.addEventListener("mouseenter",Swal.stopTimer);toast.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({...options,...{icon:icon,title:title}})}static toastSuccess(title=MESSAGES.createSuccessText,options={},completeHandler=()=>{}){return SweetAlert2.toast("success",title,{...COLOR_OPTIONS,...options},completeHandler)}static toastError(title=MESSAGES.createErrorText,options={},completeHandler=()=>{}){return SweetAlert2.toast("error",title,{...COLOR_OPTIONS,...options},completeHandler)}static toastValidationError(title=MESSAGES.validationErrorText,options={},completeHandler=()=>{}){return SweetAlert2.toast("error",title,{...COLOR_OPTIONS,...options},completeHandler)}static get MESSAGES(){return MESSAGES}}export class Tabs extends DynamicObject{constructor(selector,options={}){super(selector,options);this._$tab=this._$element;this._$tabContent=$(`${this._selector}-content`);this._currentTab=0;this._lastHash=window.location.hash;this._$tabLinks=this._$tab.find(".nav-item");this._totalTabs=this._$tabLinks.length;this._tabsCounter=0;this._$tab.on("click",e=>{window.location.hash=$(e.target).attr("href")});if(!window.location.hash)window.location.hash=$(this._$tab.find(".nav-link")[0]).attr("href");$(window).on("hashchange",e=>{this.update()});console.log("this._totalTabs",this._totalTabs)}update(){const hash=window.location.hash;if(hash==="#undefined"){window.location.hash=this._lastHash;return}this._$tab.find(".active").removeClass("active show");this._$tabContent.find(".active").removeClass("active show");$(`[href="${hash}"]`).addClass("active show");this._currentTab=$(hash).addClass("active show").index();this._$tab.find(".selected").removeClass("selected");this._$tab.find(".active").closest("li").addClass("selected");this._lastHash=hash.replace("#","");this._tabsCounter=this._currentTab;this._change.dispatch(this._currentTab,this._lastHash)}previous(){if(--this._tabsCounter<0)this._tabsCounter=this._totalTabs-1;console.log("previous tab",this._tabsCounter);$(this._$tabLinks[this._tabsCounter]).find("a").trigger({type:"click"})}next(){if(++this._tabsCounter>=this._totalTabs)this._tabsCounter=0;console.log("next tab",this._tabsCounter);$(this._$tabLinks[this._tabsCounter]).find("a").trigger({type:"click"})}}